<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechControl PRO - Centro de Mantenimiento Inteligente</title>
    <link rel="stylesheet" href="/css/dashboard-tecnico.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header Superior Futurista -->
        <header class="top-header">
            <div class="header-main">
                <div class="logo-container">
                    <div class="logo-icon">
                        <i class="fas fa-microchip"></i>
                    </div>
                    <div class="logo-text">
                        <h1>TECH CONTROL PRO</h1>
                        <span class="version">v4.0</span>
                    </div>
                </div>

                <!-- Navegación Principal -->
                <nav class="main-nav">
                    <div class="nav-container">
                        <a href="#agenda" class="nav-item" data-section="agenda">
                            <div class="nav-icon"><i class="fas fa-calendar-alt"></i></div>
                            <span class="nav-text">Agenda</span>
                            <div class="nav-pulse"></div>
                        </a>
                        <a href="#tickets" class="nav-item active" data-section="tickets">
                            <div class="nav-icon"><i class="fas fa-tasks"></i></div>
                            <span class="nav-text">Tickets</span>
                            <div class="nav-pulse"></div>
                            <span class="nav-badge">24</span>
                        </a>
                        <a href="#inventario" class="nav-item" data-section="inventario">
                            <div class="nav-icon"><i class="fas fa-server"></i></div>
                            <span class="nav-text">Inventario</span>
                            <div class="nav-pulse"></div>
                            <span class="nav-badge">8</span>
                        </a>
                        <a href="#mantenimiento" class="nav-item" data-section="mantenimiento">
                            <div class="nav-icon"><i class="fas fa-shield-alt"></i></div>
                            <span class="nav-text">Mantenimiento</span>
                            <div class="nav-pulse"></div>
                        </a>
                        <a href="#analitica" class="nav-item" data-section="analitica">
                            <div class="nav-icon"><i class="fas fa-chart-network"></i></div>
                            <span class="nav-text">Analítica</span>
                            <div class="nav-pulse"></div>
                        </a>
                    </div>
                </nav>

                <!-- User Info y Controles -->
                <div class="header-controls">
                    <div class="system-status">
                        <div class="status-item">
                            <div class="status-dot online"></div>
                            <span>SISTEMA</span>
                        </div>
                        <div class="status-item">
                            <div class="status-dot active"></div>
                            <span>IA ACTIVA</span>
                        </div>
                    </div>
                    
                    <div class="user-profile">
                        <div class="user-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="user-info">
                            <span class="user-name">CARLOS MARTÍNEZ</span>
                            <span class="user-role">INGENIERO SENIOR</span>
                        </div>
                    </div>

                    <div class="header-actions">
                        <button class="action-btn primary" onclick="dashboard.openNewTicketModal()">
                            <i class="fas fa-plus"></i>
                            NUEVO TICKET
                        </button>
                        <div class="notification-center" onclick="dashboard.toggleNotifications()">
                            <i class="fas fa-radar"></i>
                            <span class="notification-count">3</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sub-navegación Contextual -->
            <div class="sub-nav" id="ticketsSubNav">
                <div class="sub-nav-container">
                    <div class="sub-nav-item active" data-filter="all">
                        <span>TODOS</span>
                        <span class="count">24</span>
                    </div>
                    <div class="sub-nav-item" data-filter="critical">
                        <span>CRÍTICOS</span>
                        <span class="count">3</span>
                    </div>
                    <div class="sub-nav-item" data-filter="progress">
                        <span>EN PROGRESO</span>
                        <span class="count">8</span>
                    </div>
                    <div class="sub-nav-item" data-filter="pending">
                        <span>PENDIENTES</span>
                        <span class="count">5</span>
                    </div>
                    <div class="sub-nav-item" data-filter="completed">
                        <span>COMPLETADOS</span>
                        <span class="count">8</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Panel de Notificaciones -->
            <div class="notifications-panel" id="notificationsPanel">
                <div class="panel-header">
                    <h3><i class="fas fa-radar"></i> CENTRO DE ALERTAS</h3>
                    <button class="panel-close" onclick="dashboard.closeNotificationsPanel()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="alerts-container" id="notificationsContainer">
                    <!-- Notificaciones se cargan dinámicamente -->
                </div>
            </div>

            <!-- Contenedor para notificaciones toast -->
            <div id="toastContainer" class="toast-container"></div>

            <!-- Sección Agenda -->
            <section id="agenda" class="dashboard-section">
                <div class="section-header">
                    <div class="header-title">
                        <h2><i class="fas fa-calendar-alt"></i> AGENDA OPERATIVA</h2>
                        <p class="subtitle">Planificación y seguimiento de actividades de mantenimiento</p>
                    </div>
                    <div class="header-actions">
                        <div class="date-navigation">
                            <button class="nav-btn" onclick="dashboard.previousDay()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <span class="current-date" id="currentDate">LUNES, 15 ENERO 2024</span>
                            <button class="nav-btn" onclick="dashboard.nextDay()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <button class="action-btn primary" onclick="dashboard.openNewEventModal()">
                            <i class="fas fa-plus"></i>
                            NUEVO EVENTO
                        </button>
                    </div>
                </div>

                <div class="quick-metrics">
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Eventos Hoy</h3>
                            <div class="metric-value" data-stat="today-events">8</div>
                            <div class="metric-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                2 más que ayer
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Urgentes</h3>
                            <div class="metric-value">3</div>
                            <div class="metric-trend negative">
                                <i class="fas fa-arrow-up"></i>
                                1 nuevo
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Técnicos Activos</h3>
                            <div class="metric-value">6</div>
                            <div class="metric-trend neutral">
                                <i class="fas fa-minus"></i>
                                Estable
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Completados</h3>
                            <div class="metric-value">12</div>
                            <div class="metric-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                15% mejor
                            </div>
                        </div>
                    </div>
                </div>

                <div class="agenda-view">
                    <div class="timeline-container">
                        <div class="timeline-period">
                            <div class="period-header">
                                <span class="period-time">08:00 - 12:00</span>
                                <span class="period-label">TURNO MAÑANA</span>
                            </div>
                            <div class="timeline-events" id="todayAgenda">
                                <!-- Eventos se cargan dinámicamente -->
                            </div>
                        </div>

                        <div class="timeline-period">
                            <div class="period-header">
                                <span class="period-time">14:00 - 18:00</span>
                                <span class="period-label">TURNO TARDE</span>
                            </div>
                            <div class="timeline-events">
                                <!-- Eventos de tarde se cargan dinámicamente -->
                            </div>
                        </div>
                    </div>

                    <div class="upcoming-events">
                        <div class="panel-header">
                            <h3>PRÓXIMOS EVENTOS</h3>
                            <button class="action-btn outline" onclick="dashboard.syncAgenda()">
                                <i class="fas fa-sync-alt"></i>
                                SINCRONIZAR
                            </button>
                        </div>
                        <div class="events-list" id="upcomingAgenda">
                            <!-- Eventos próximos se cargan dinámicamente -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección Tickets -->
            <section id="tickets" class="dashboard-section active">
                <div class="section-header">
                    <div class="header-title">
                        <h2><i class="fas fa-tasks"></i> GESTIÓN AVANZADA DE TICKETS</h2>
                        <p class="subtitle">Sistema integral de seguimiento y gestión de mantenimiento</p>
                    </div>
                    <div class="header-actions">
                        <div class="view-controls">
                            <button class="view-btn active" data-view="grid" onclick="dashboard.changeView('grid')">
                                <i class="fas fa-th"></i>
                                <span>Grid</span>
                            </button>
                            <button class="view-btn" data-view="kanban" onclick="dashboard.changeView('kanban')">
                                <i class="fas fa-columns"></i>
                                <span>Kanban</span>
                            </button>
                            <button class="view-btn" data-view="list" onclick="dashboard.changeView('list')">
                                <i class="fas fa-list"></i>
                                <span>Lista</span>
                            </button>
                        </div>
                        <div class="action-buttons">
                            <button class="action-btn outline" onclick="dashboard.exportTickets()">
                                <i class="fas fa-download"></i>
                                EXPORTAR
                            </button>
                            <button class="action-btn outline" onclick="dashboard.showBulkActions()">
                                <i class="fas fa-cog"></i>
                                ACCIONES MASIVAS
                            </button>
                        </div>
                    </div>
                </div>

                <div class="filters-bar">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="ticketSearch" placeholder="Buscar tickets, ubicaciones, técnicos...">
                        <button class="search-clear" onclick="dashboard.clearSearch()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="filters-group">
                        <select class="filter-select" id="statusFilter" onchange="dashboard.filterTickets()">
                            <option value="all">Todos los estados</option>
                            <option value="pending">Pendientes</option>
                            <option value="in-progress">En progreso</option>
                            <option value="waiting">Esperando repuesto</option>
                            <option value="completed">Completados</option>
                        </select>
                        
                        <select class="filter-select" id="priorityFilter" onchange="dashboard.filterTickets()">
                            <option value="all">Todas las prioridades</option>
                            <option value="critical">Crítica</option>
                            <option value="high">Alta</option>
                            <option value="medium">Media</option>
                            <option value="low">Baja</option>
                        </select>
                        
                        <select class="filter-select" id="categoryFilter" onchange="dashboard.filterTickets()">
                            <option value="all">Todas las categorías</option>
                            <option value="hvac">HVAC</option>
                            <option value="electrico">Eléctrico</option>
                            <option value="hidraulico">Hidráulico</option>
                            <option value="seguridad">Seguridad</option>
                            <option value="estructural">Estructural</option>
                            <option value="iluminacion">Iluminación</option>
                        </select>
                    </div>
                </div>

                <div class="quick-metrics">
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Tiempo Respuesta Promedio</h3>
                            <div class="metric-value">28 min</div>
                            <div class="metric-trend positive">
                                <i class="fas fa-arrow-down"></i>
                                12% mejor
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Tickets Completados Hoy</h3>
                            <div class="metric-value">6</div>
                            <div class="metric-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                2 más que ayer
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Tickets Críticos Activos</h3>
                            <div class="metric-value">3</div>
                            <div class="metric-trend negative">
                                <i class="fas fa-arrow-up"></i>
                                1 nuevo
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Técnicos Activos</h3>
                            <div class="metric-value">8/12</div>
                            <div class="metric-trend neutral">
                                <i class="fas fa-minus"></i>
                                Estable
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Barra de acciones masivas -->
                <div class="bulk-actions-bar" id="bulkActions" style="display: none;">
                    <div class="bulk-info">
                        <span id="selectedCount">0</span> tickets seleccionados
                    </div>
                    <div class="bulk-buttons">
                        <button class="btn outline small" onclick="dashboard.bulkAssign()">
                            <i class="fas fa-user"></i> Asignar
                        </button>
                        <button class="btn outline small" onclick="dashboard.bulkChangePriority()">
                            <i class="fas fa-flag"></i> Prioridad
                        </button>
                        <button class="btn outline small" onclick="dashboard.bulkChangeStatus()">
                            <i class="fas fa-sync"></i> Estado
                        </button>
                        <button class="btn outline small error" onclick="dashboard.bulkDelete()">
                            <i class="fas fa-trash"></i> Eliminar
                        </button>
                        <button class="btn outline small" onclick="dashboard.clearSelections()">
                            <i class="fas fa-times"></i> Limpiar
                        </button>
                    </div>
                </div>

                <!-- Vista Kanban -->
                <div class="kanban-view" id="kanbanView" style="display: none;">
                    <div class="kanban-container">
                        <div class="kanban-column" data-status="pending">
                            <div class="column-header pending">
                                <h3>PENDIENTES</h3>
                                <span class="column-count">5</span>
                            </div>
                            <div class="kanban-cards" id="kanbanPending">
                                <!-- Tickets pendientes se cargan aquí -->
                            </div>
                        </div>
                        
                        <div class="kanban-column" data-status="in-progress">
                            <div class="column-header progress">
                                <h3>EN PROGRESO</h3>
                                <span class="column-count">8</span>
                            </div>
                            <div class="kanban-cards" id="kanbanProgress">
                                <!-- Tickets en progreso se cargan aquí -->
                            </div>
                        </div>
                        
                        <div class="kanban-column" data-status="waiting">
                            <div class="column-header waiting">
                                <h3>ESPERANDO</h3>
                                <span class="column-count">3</span>
                            </div>
                            <div class="kanban-cards" id="kanbanWaiting">
                                <!-- Tickets en espera se cargan aquí -->
                            </div>
                        </div>
                        
                        <div class="kanban-column" data-status="completed">
                            <div class="column-header completed">
                                <h3>COMPLETADOS</h3>
                                <span class="column-count">8</span>
                            </div>
                            <div class="kanban-cards" id="kanbanCompleted">
                                <!-- Tickets completados se cargan aquí -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Vista Grid (Por defecto) -->
                <div class="tickets-grid-view" id="gridView">
                    <div class="grid-header">
                        <div class="grid-info">
                            <span class="tickets-count">Mostrando 24 tickets</span>
                            <span class="tickets-filtered" id="filteredCount"></span>
                        </div>
                        <div class="grid-sort">
                            <select class="sort-select" id="sortSelect" onchange="dashboard.sortTickets()">
                                <option value="newest">Más recientes primero</option>
                                <option value="oldest">Más antiguos primero</option>
                                <option value="priority">Por prioridad</option>
                                <option value="status">Por estado</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="tickets-grid" id="ticketsGrid">
                        <!-- Los tickets se cargan dinámicamente aquí -->
                    </div>
                    
                    <div class="grid-footer">
                        <div class="pagination">
                            <button class="page-btn" onclick="dashboard.previousPage()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <span class="page-info">Página 1 de 3</span>
                            <button class="page-btn" onclick="dashboard.nextPage()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Vista Lista -->
                <div class="tickets-list-view" id="listView" style="display: none;">
                    <div class="table-container">
                        <table class="tickets-table">
                            <thead>
                                <tr>
                                    <th class="select-col">
                                        <input type="checkbox" id="selectAll" onchange="dashboard.toggleSelectAll()">
                                    </th>
                                    <th class="id-col">ID</th>
                                    <th class="title-col">TÍTULO</th>
                                    <th class="priority-col">PRIORIDAD</th>
                                    <th class="status-col">ESTADO</th>
                                    <th class="category-col">CATEGORÍA</th>
                                    <th class="technician-col">TÉCNICO</th>
                                    <th class="date-col">FECHA CREACIÓN</th>
                                    <th class="actions-col">ACCIONES</th>
                                </tr>
                            </thead>
                            <tbody id="ticketsTableBody">
                                <!-- Tickets en vista tabla se cargan aquí -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Sección Inventario -->
            <section id="inventario" class="dashboard-section">
                <div class="section-header">
                    <div class="header-title">
                        <h2><i class="fas fa-server"></i> SISTEMA DE INVENTARIO INTELIGENTE</h2>
                        <p class="subtitle">Gestión y control de materiales, repuestos y herramientas</p>
                    </div>
                    <div class="header-actions">
                        <button class="action-btn primary" onclick="dashboard.openNewItemModal()">
                            <i class="fas fa-plus"></i>
                            NUEVO ITEM
                        </button>
                        <button class="action-btn outline" onclick="dashboard.exportInventory()">
                            <i class="fas fa-download"></i>
                            EXPORTAR
                        </button>
                    </div>
                </div>

                <div class="quick-metrics">
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Total Items</h3>
                            <div class="metric-value" data-stat="total-items">156</div>
                            <div class="metric-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                12 nuevos
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card critical">
                        <div class="metric-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Stock Crítico</h3>
                            <div class="metric-value" data-stat="critical-items">8</div>
                            <div class="metric-trend negative">
                                <i class="fas fa-arrow-up"></i>
                                3 más
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card warning">
                        <div class="metric-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Stock Bajo</h3>
                            <div class="metric-value" data-stat="low-items">23</div>
                            <div class="metric-trend negative">
                                <i class="fas fa-arrow-up"></i>
                                5 más
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-tools"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Herramientas</h3>
                            <div class="metric-value">45</div>
                            <div class="metric-trend neutral">
                                <i class="fas fa-minus"></i>
                                Estable
                            </div>
                        </div>
                    </div>
                </div>

                <div class="filters-bar">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="inventorySearch" placeholder="Buscar items, categorías, ubicaciones..." oninput="dashboard.searchInventory(this.value)">
                        <button class="search-clear" onclick="dashboard.clearInventorySearch()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="filters-group">
                        <select class="filter-select" id="inventoryCategoryFilter" onchange="dashboard.filterInventory()">
                            <option value="all">Todas las categorías</option>
                            <option value="hvac">HVAC</option>
                            <option value="electrico">Eléctrico</option>
                            <option value="hidraulico">Hidráulico</option>
                            <option value="herramientas">Herramientas</option>
                            <option value="seguridad">Seguridad</option>
                            <option value="sensores">Sensores</option>
                        </select>
                        
                        <select class="filter-select" id="inventoryStatusFilter" onchange="dashboard.filterInventory()">
                            <option value="all">Todos los estados</option>
                            <option value="critical">Stock Crítico</option>
                            <option value="low">Stock Bajo</option>
                            <option value="normal">Stock Normal</option>
                        </select>
                        
                        <select class="filter-select" id="inventoryLocationFilter" onchange="dashboard.filterInventory()">
                            <option value="all">Todas las ubicaciones</option>
                            <option value="almacen-a">Almacén A</option>
                            <option value="almacen-b">Almacén B</option>
                            <option value="almacen-c">Almacén C</option>
                        </select>
                    </div>
                </div>

                <div class="inventory-view">
                    <div class="table-container">
                        <table class="inventory-table">
                            <thead>
                                <tr>
                                    <th class="select-col">
                                        <input type="checkbox" id="selectAllInventory" onchange="dashboard.toggleSelectAllInventory()">
                                    </th>
                                    <th class="name-col">ITEM</th>
                                    <th class="category-col">CATEGORÍA</th>
                                    <th class="stock-col">STOCK ACTUAL</th>
                                    <th class="min-col">STOCK MÍNIMO</th>
                                    <th class="location-col">UBICACIÓN</th>
                                    <th class="status-col">ESTADO</th>
                                    <th class="actions-col">ACCIONES</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTableBody">
                                <!-- Items de inventario se cargan dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Sección Mantenimiento -->
            <section id="mantenimiento" class="dashboard-section">
                <div class="section-header">
                    <div class="header-title">
                        <h2><i class="fas fa-shield-alt"></i> SISTEMA DE MANTENIMIENTO PREVENTIVO</h2>
                        <p class="subtitle">Programación y ejecución de mantenimientos planificados</p>
                    </div>
                    <div class="header-actions">
                        <button class="action-btn primary" onclick="dashboard.scheduleMaintenance()">
                            <i class="fas fa-plus"></i>
                            PROGRAMAR MANTENIMIENTO
                        </button>
                        <button class="action-btn outline" onclick="dashboard.generateMaintenanceReport()">
                            <i class="fas fa-chart-bar"></i>
                            REPORTES
                        </button>
                    </div>
                </div>

                <div class="quick-metrics">
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Programados Hoy</h3>
                            <div class="metric-value" data-stat="today">3</div>
                            <div class="metric-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                1 más que ayer
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Próximos 7 Días</h3>
                            <div class="metric-value" data-stat="upcoming">8</div>
                            <div class="metric-trend neutral">
                                <i class="fas fa-minus"></i>
                                Estable
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Completados Mes</h3>
                            <div class="metric-value" data-stat="completed">24</div>
                            <div class="metric-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                15% mejor
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="metric-content">
                            <h3>Retrasados</h3>
                            <div class="metric-value" data-stat="overdue">2</div>
                            <div class="metric-trend negative">
                                <i class="fas fa-arrow-up"></i>
                                1 más
                            </div>
                        </div>
                    </div>
                </div>

                <div class="maintenance-tabs">
                    <div class="tabs-header">
                        <div class="tabs-navigation">
                            <button class="tab-btn active" data-tab="today" onclick="dashboard.switchMaintenanceTab('today')">
                                <i class="fas fa-calendar-day"></i>
                                <span>Hoy</span>
                                <span class="tab-badge">3</span>
                            </button>
                            <button class="tab-btn" data-tab="upcoming" onclick="dashboard.switchMaintenanceTab('upcoming')">
                                <i class="fas fa-clock"></i>
                                <span>Próximos</span>
                                <span class="tab-badge">8</span>
                            </button>
                            <button class="tab-btn" data-tab="overdue" onclick="dashboard.switchMaintenanceTab('overdue')">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span>Retrasados</span>
                                <span class="tab-badge">2</span>
                            </button>
                            <button class="tab-btn" data-tab="completed" onclick="dashboard.switchMaintenanceTab('completed')">
                                <i class="fas fa-check-circle"></i>
                                <span>Completados</span>
                                <span class="tab-badge">24</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tabs-content">
                        <div id="maintenanceContent" class="tab-content active">
                            <!-- Contenido de mantenimiento se carga dinámicamente -->
                        </div>
                    </div>
                </div>

                <div class="maintenance-calendar">
                    <div class="calendar-header">
                        <h3>CALENDARIO DE MANTENIMIENTO</h3>
                        <div class="calendar-controls">
                            <button class="nav-btn" onclick="dashboard.previousMonth()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <span class="current-month" id="currentMonth">ENERO 2024</span>
                            <button class="nav-btn" onclick="dashboard.nextMonth()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="calendar-grid" id="maintenanceCalendar">
                        <!-- Calendario se genera dinámicamente -->
                    </div>
                </div>
            </section>

            <!-- Sección Analítica -->
            <section id="analitica" class="dashboard-section">
                <div class="section-header">
                    <div class="header-title">
                        <h2><i class="fas fa-chart-network"></i> CENTRO DE ANÁLISIS INTELIGENTE</h2>
                        <p class="subtitle">Métricas, tendencias y análisis predictivo del sistema</p>
                    </div>
                    <div class="header-actions">
                        <div class="date-range">
                            <select class="range-select" id="analyticsRange" onchange="dashboard.updateAnalytics()">
                                <option value="7d">Últimos 7 días</option>
                                <option value="30d">Últimos 30 días</option>
                                <option value="90d">Últimos 90 días</option>
                                <option value="ytd">Este año</option>
                            </select>
                        </div>
                        <button class="action-btn outline" onclick="dashboard.exportAnalytics()">
                            <i class="fas fa-download"></i>
                            EXPORTAR DATOS
                        </button>
                    </div>
                </div>

                <div class="kpi-grid">
                    <div class="kpi-card primary">
                        <div class="kpi-icon">
                            <i class="fas fa-tachometer-alt"></i>
                        </div>
                        <div class="kpi-content">
                            <h3>Eficiencia General</h3>
                            <div class="kpi-value" data-stat="efficiency">94.7%</div>
                            <div class="kpi-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                2.3% vs mes anterior
                            </div>
                        </div>
                    </div>
                    
                    <div class="kpi-card success">
                        <div class="kpi-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="kpi-content">
                            <h3>Tickets Resueltos</h3>
                            <div class="kpi-value" data-stat="ticketsResolved">87%</div>
                            <div class="kpi-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                5.2% vs mes anterior
                            </div>
                        </div>
                    </div>
                    
                    <div class="kpi-card warning">
                        <div class="kpi-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="kpi-content">
                            <h3>Tiempo Respuesta</h3>
                            <div class="kpi-value" data-stat="responseTime">28 min</div>
                            <div class="kpi-trend negative">
                                <i class="fas fa-arrow-up"></i>
                                3 min más
                            </div>
                        </div>
                    </div>
                    
                    <div class="kpi-card info">
                        <div class="kpi-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="kpi-content">
                            <h3>Productividad</h3>
                            <div class="kpi-value" data-stat="productivity">78%</div>
                            <div class="kpi-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                8.1% vs mes anterior
                            </div>
                        </div>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-container large">
                        <div class="chart-header">
                            <h4>TENDENCIA DE TICKETS POR CATEGORÍA</h4>
                            <div class="chart-legend" id="categoryLegend"></div>
                        </div>
                        <canvas id="categoryTrendChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-header">
                            <h4>DISTRIBUCIÓN POR PRIORIDAD</h4>
                        </div>
                        <canvas id="priorityDistributionChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-header">
                            <h4>EFICIENCIA POR TÉCNICO</h4>
                        </div>
                        <canvas id="technicianEfficiencyChart"></canvas>
                    </div>
                </div>

                <div class="predictive-analytics">
                    <div class="analytics-header">
                        <h3><i class="fas fa-brain"></i> ANÁLISIS PREDICTIVO</h3>
                        <span class="confidence-level">Confianza: 92%</span>
                    </div>
                    <div class="predictive-grid">
                        <div class="prediction-card">
                            <div class="prediction-icon high-risk">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="prediction-content">
                                <h4>ALTO RIESGO PREDICHO</h4>
                                <p>Sistema HVAC - Torre Norte</p>
                                <span class="prediction-time">Probable en 7-10 días</span>
                            </div>
                            <div class="prediction-actions">
                                <button class="btn outline small" onclick="dashboard.schedulePredictedMaintenance('hvac-north')">PROGRAMAR REVISIÓN</button>
                            </div>
                        </div>
                        
                        <div class="prediction-card">
                            <div class="prediction-icon medium-risk">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="prediction-content">
                                <h4>MANTENIMIENTO RECOMENDADO</h4>
                                <p>Ascensores Torre Este</p>
                                <span class="prediction-time">Recomendado en 14 días</span>
                            </div>
                            <div class="prediction-actions">
                                <button class="btn outline small" onclick="dashboard.schedulePredictedMaintenance('elevators-east')">AGENDAR</button>
                            </div>
                        </div>

                        <div class="prediction-card">
                            <div class="prediction-icon low-risk">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="prediction-content">
                                <h4>OPTIMIZACIÓN IDENTIFICADA</h4>
                                <p>Sistema Eléctrico Principal</p>
                                <span class="prediction-time">Ahorro potencial: 15% energía</span>
                            </div>
                            <div class="prediction-actions">
                                <button class="btn outline small" onclick="dashboard.viewOptimizationDetails()">ANALIZAR</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="detailed-metrics">
                    <div class="metrics-grid">
                        <div class="metric-detail-card">
                            <h4>TIEMPO PROMEDIO RESOLUCIÓN</h4>
                            <div class="metric-detail-value">2.3 <span>días</span></div>
                            <div class="metric-detail-trend positive">
                                <i class="fas fa-arrow-down"></i>
                                12% mejoría
                            </div>
                        </div>
                        <div class="metric-detail-card">
                            <h4>COSTO MANTENIMIENTO MENSUAL</h4>
                            <div class="metric-detail-value">$12,450</div>
                            <div class="metric-detail-trend negative">
                                <i class="fas fa-arrow-up"></i>
                                8% aumento
                            </div>
                        </div>
                        <div class="metric-detail-card">
                            <h4>DISPONIBILIDAD SISTEMA</h4>
                            <div class="metric-detail-value">99.2%</div>
                            <div class="metric-detail-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                0.3% mejoría
                            </div>
                        </div>
                        <div class="metric-detail-card">
                            <h4>TICKETS PREVENTIVOS</h4>
                            <div class="metric-detail-value">68%</div>
                            <div class="metric-detail-trend positive">
                                <i class="fas fa-arrow-up"></i>
                                15% más
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal Nuevo Ticket -->
    <div class="modal-overlay" id="newTicketModal">
        <div class="modal-container">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> CREAR NUEVO TICKET</h3>
                <button class="modal-close" onclick="dashboard.closeModal('newTicketModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="newTicketForm" class="ticket-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ticketTitle">Título del Ticket *</label>
                            <input type="text" id="ticketTitle" placeholder="Ej: Fuga en sistema hidráulico - Torre B" required>
                        </div>
                        <div class="form-group">
                            <label for="ticketCategory">Categoría *</label>
                            <select id="ticketCategory" required>
                                <option value="">Seleccionar categoría</option>
                                <option value="hvac">HVAC</option>
                                <option value="electrico">Eléctrico</option>
                                <option value="hidraulico">Hidráulico</option>
                                <option value="seguridad">Seguridad</option>
                                <option value="estructural">Estructural</option>
                                <option value="iluminacion">Iluminación</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ticketPriority">Prioridad *</label>
                            <select id="ticketPriority" required>
                                <option value="">Seleccionar prioridad</option>
                                <option value="critical">Crítica</option>
                                <option value="high">Alta</option>
                                <option value="medium">Media</option>
                                <option value="low">Baja</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ticketLocation">Ubicación *</label>
                            <input type="text" id="ticketLocation" placeholder="Ej: Torre Norte - Nivel 12" required>
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="ticketDescription">Descripción Detallada *</label>
                        <textarea id="ticketDescription" rows="4" placeholder="Describa el problema, síntomas observados, y cualquier información relevante..." required></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="assignedTechnician">Técnico Asignado</label>
                            <select id="assignedTechnician">
                                <option value="">Asignar automáticamente</option>
                                <option value="tech-001">Carlos Martínez</option>
                                <option value="tech-002">Ana López</option>
                                <option value="tech-003">Miguel Ángel</option>
                                <option value="tech-004">Laura Sánchez</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="estimatedTime">Tiempo Estimado (horas)</label>
                            <input type="number" id="estimatedTime" min="0.5" max="24" step="0.5" placeholder="2.5">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn outline" onclick="dashboard.closeModal('newTicketModal')">CANCELAR</button>
                <button class="btn primary" onclick="dashboard.submitNewTicket()">CREAR TICKET</button>
            </div>
        </div>
    </div>

    <!-- Modal Detalles de Ticket -->
    <div class="modal-overlay" id="ticketDetailsModal">
        <div class="modal-container large">
            <div class="modal-header">
                <h3><i class="fas fa-info-circle"></i> DETALLES DEL TICKET</h3>
                <button class="modal-close" onclick="dashboard.closeModal('ticketDetailsModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="ticket-details">
                    <div class="detail-section">
                        <h4>Información General</h4>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <label>ID:</label>
                                <span id="detailTicketId">-</span>
                            </div>
                            <div class="detail-item">
                                <label>Prioridad:</label>
                                <span id="detailTicketPriority" class="priority-badge">-</span>
                            </div>
                            <div class="detail-item">
                                <label>Estado:</label>
                                <span id="detailTicketStatus" class="status-badge">-</span>
                            </div>
                            <div class="detail-item">
                                <label>Categoría:</label>
                                <span id="detailTicketCategory">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Descripción</h4>
                        <p id="detailTicketDescription">-</p>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Ubicación y Asignación</h4>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <label>Ubicación:</label>
                                <span id="detailTicketLocation">-</span>
                            </div>
                            <div class="detail-item">
                                <label>Técnico:</label>
                                <span id="detailTicketTechnician">-</span>
                            </div>
                            <div class="detail-item">
                                <label>Supervisor:</label>
                                <span id="detailTicketSupervisor">-</span>
                            </div>
                            <div class="detail-item">
                                <label>Tiempo Estimado:</label>
                                <span id="detailTicketEstimated">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Fechas</h4>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <label>Creación:</label>
                                <span id="detailTicketCreated">-</span>
                            </div>
                            <div class="detail-item">
                                <label>Programado:</label>
                                <span id="detailTicketScheduled">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Materiales Requeridos</h4>
                        <ul id="detailTicketMaterials" class="materials-list">
                            <!-- Materiales se cargan dinámicamente -->
                        </ul>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Progreso</h4>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" id="detailTicketProgress" style="width: 0%"></div>
                            </div>
                            <span class="progress-text" id="detailTicketProgressText">0% completado</span>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Historial</h4>
                        <div class="history-timeline" id="detailTicketHistory">
                            <!-- Historial se carga dinámicamente -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn outline" onclick="dashboard.closeModal('ticketDetailsModal')">CERRAR</button>
                <button class="btn primary" onclick="dashboard.editCurrentTicket()">EDITAR</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/js/dashboard-tecnico.js"></script>
</body>
</html>