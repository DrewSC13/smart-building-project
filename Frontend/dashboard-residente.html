<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BuildingPRO - Dashboard Residente Inteligente</title>
    <link rel="stylesheet" href="dashboard-residente.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar Futurista Mejorado -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo-container">
                    <div class="logo-glow"></div>
                    <div class="logo">
                        <i class="fas fa-building"></i>
                    </div>
                </div>
                <h2>Mi Espacio</h2>
                <span class="role-badge">Residente</span>
            </div>
            
            <div class="user-info">
                <div class="user-avatar">
                    <img src="https://ui-avatars.com/api/?name=Juan+Perez&background=6366f1&color=fff" alt="Residente">
                    <div class="online-status"></div>
                </div>
                <div class="user-details">
                    <h3 id="sidebar-resident-name">Juan Pérez</h3>
                    <p id="sidebar-apartment-info">Departamento 5A - Torre 1</p>
                </div>
            </div>
            
            <ul class="sidebar-menu">
                <li>
                    <a href="#inicio" class="active">
                        <div class="menu-icon">
                            <i class="fas fa-home"></i>
                        </div>
                        <span class="menu-text">Inicio</span>
                        <div class="menu-indicator"></div>
                    </a>
                </li>
                <li>
                    <a href="#finanzas">
                        <div class="menu-icon">
                            <i class="fas fa-credit-card"></i>
                        </div>
                        <span class="menu-text">Mis Finanzas</span>
                        <div class="menu-indicator"></div>
                    </a>
                </li>
                <li>
                    <a href="#reservas">
                        <div class="menu-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <span class="menu-text">Reservas</span>
                        <div class="menu-indicator"></div>
                    </a>
                </li>
                <li>
                    <a href="#areas-comunes">
                        <div class="menu-icon">
                            <i class="fas fa-swimming-pool"></i>
                        </div>
                        <span class="menu-text">Áreas Comunes</span>
                        <div class="menu-indicator"></div>
                    </a>
                </li>
                <li>
                    <a href="#mantenimiento">
                        <div class="menu-icon">
                            <i class="fas fa-tools"></i>
                        </div>
                        <span class="menu-text">Mantenimiento</span>
                        <div class="menu-indicator"></div>
                    </a>
                </li>
                <li>
                    <a href="#emergencias">
                        <div class="menu-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <span class="menu-text">Emergencias</span>
                        <div class="menu-indicator"></div>
                    </a>
                </li>
                <li>
                    <a href="#consumo">
                        <div class="menu-icon">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        <span class="menu-text">Mi Consumo</span>
                        <div class="menu-indicator"></div>
                    </a>
                </li>
                <li>
                    <a href="#comunidad">
                        <div class="menu-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <span class="menu-text">Comunidad</span>
                        <div class="menu-indicator"></div>
                    </a>
                </li>
                <li>
                    <a href="#configuracion">
                        <div class="menu-icon">
                            <i class="fas fa-cog"></i>
                        </div>
                        <span class="menu-text">Configuración</span>
                        <div class="menu-indicator"></div>
                    </a>
                </li>
                <li class="menu-divider"></li>
                <li>
                    <a href="#" id="logout-btn">
                        <div class="menu-icon">
                            <i class="fas fa-sign-out-alt"></i>
                        </div>
                        <span class="menu-text">Cerrar Sesión</span>
                        <div class="menu-indicator"></div>
                    </a>
                </li>
            </ul>
            
            <div class="sidebar-footer">
                <div class="ai-assistant" onclick="toggleAIAssistant()">
                    <div class="ai-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <span>Asistente IA</span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <div class="welcome-message">
                    <h1>¡Bienvenido de vuelta, <span id="resident-name">Juan Pérez</span>!</h1>
                    <p id="apartment-info">Departamento 5A - Torre 1</p>
                </div>
                <div class="header-actions">
                    <div class="quick-actions">
                        <button class="btn btn-primary btn-glow" onclick="openQuickReserve()">
                            <i class="fas fa-plus"></i> Nueva Reserva
                        </button>
                        <button class="btn btn-secondary btn-glow" onclick="openMaintenanceRequest()">
                            <i class="fas fa-exclamation-circle"></i> Reportar Problema
                        </button>
                    </div>
                    <div class="header-icons">
                        <div class="notification-icon" onclick="toggleNotifications()">
                            <i class="fas fa-bell"></i>
                            <span class="badge">5</span>
                        </div>
                        <div class="user-avatar" onclick="toggleUserMenu()">
                            <img src="https://ui-avatars.com/api/?name=Juan+Perez&background=6366f1&color=fff" alt="Residente">
                            <div class="user-menu">
                                <a href="#configuracion"><i class="fas fa-cog"></i> Configuración</a>
                                <a href="#" id="user-menu-logout"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Notificaciones Dropdown -->
            <div class="notifications-dropdown" id="notificationsDropdown">
                <div class="notifications-header">
                    <h3>Notificaciones</h3>
                    <span class="badge">5 nuevas</span>
                </div>
                <div class="notifications-list">
                    <div class="notification-item unread">
                        <div class="notification-icon success">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="notification-content">
                            <p>Tu reserva de la Sala de Eventos ha sido confirmada</p>
                            <span class="notification-time">Hace 2 horas</span>
                        </div>
                    </div>
                    <div class="notification-item unread">
                        <div class="notification-icon info">
                            <i class="fas fa-file-invoice-dollar"></i>
                        </div>
                        <div class="notification-content">
                            <p>Recordatorio: Pago de mantenimiento vence en 3 días</p>
                            <span class="notification-time">Hace 5 horas</span>
                        </div>
                    </div>
                    <div class="notification-item">
                        <div class="notification-icon warning">
                            <i class="fas fa-tools"></i>
                        </div>
                        <div class="notification-content">
                            <p>Tu solicitud de mantenimiento está en proceso</p>
                            <span class="notification-time">Ayer</span>
                        </div>
                    </div>
                </div>
                <div class="notifications-footer">
                    <a href="#">Ver todas las notificaciones</a>
                </div>
            </div>

            <!-- Sección Inicio -->
            <section id="inicio" class="dashboard-section active">
                <!-- Alertas Importantes -->
                <div class="alert-banner urgent">
                    <div class="alert-content">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <h4>Corte programado de agua</h4>
                            <p>Mañana 15 Ene de 9:00 AM a 12:00 PM - Planifique sus actividades</p>
                        </div>
                    </div>
                    <button class="btn-close" onclick="closeAlert(this)">&times;</button>
                </div>

                <!-- Tarjetas de Estado Rápido -->
                <div class="quick-status-cards">
                    <div class="status-card">
                        <div class="status-icon pending">
                            <i class="fas fa-file-invoice-dollar"></i>
                        </div>
                        <div class="status-content">
                            <h3>2</h3>
                            <p>Pagos Pendientes</p>
                            <span class="status-amount">$335.25</span>
                        </div>
                        <button class="btn-link" onclick="switchSection('finanzas')">Ver detalles</button>
                    </div>

                    <div class="status-card">
                        <div class="status-icon confirmed">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="status-content">
                            <h3>1</h3>
                            <p>Reservas Activas</p>
                            <span class="status-next">Sala eventos - 20 Ene</span>
                        </div>
                        <button class="btn-link" onclick="switchSection('reservas')">Ver calendario</button>
                    </div>

                    <div class="status-card">
                        <div class="status-icon in-progress">
                            <i class="fas fa-tools"></i>
                        </div>
                        <div class="status-content">
                            <h3>1</h3>
                            <p>Mantenimientos</p>
                            <span class="status-next">En proceso - Grifería</span>
                        </div>
                        <button class="btn-link" onclick="switchSection('mantenimiento')">Seguimiento</button>
                    </div>

                    <div class="status-card">
                        <div class="status-icon normal">
                            <i class="fas fa-building"></i>
                        </div>
                        <div class="status-content">
                            <h3>22°C</h3>
                            <p>Temperatura Interior</p>
                            <span class="status-next">Confortable</span>
                        </div>
                        <button class="btn-link" onclick="viewBuildingStatus()">Estado edificio</button>
                    </div>
                </div>

                <!-- Próximos Vencimientos -->
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-clock"></i> Próximos Vencimientos</h2>
                        <a href="#finanzas" class="view-all">Ver todos</a>
                    </div>
                    <div class="payments-list">
                        <div class="payment-item">
                            <div class="payment-info">
                                <div class="payment-icon">
                                    <i class="fas fa-home"></i>
                                </div>
                                <div>
                                    <h4>Mantenimiento Mensual</h4>
                                    <p>Vence el 05 Feb 2024</p>
                                </div>
                            </div>
                            <div class="payment-amount">
                                <span class="amount">$250.00</span>
                                <button class="btn btn-primary btn-sm" onclick="processPayment(this)">Pagar ahora</button>
                            </div>
                        </div>

                        <div class="payment-item">
                            <div class="payment-info">
                                <div class="payment-icon">
                                    <i class="fas fa-tint"></i>
                                </div>
                                <div>
                                    <h4>Servicio de Agua</h4>
                                    <p>Vence el 10 Feb 2024</p>
                                </div>
                            </div>
                            <div class="payment-amount">
                                <span class="amount">$85.50</span>
                                <button class="btn btn-primary btn-sm" onclick="processPayment(this)">Pagar ahora</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reservas Próximas -->
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-calendar-alt"></i> Mis Reservas</h2>
                        <a href="#reservas" class="view-all">Ver calendario</a>
                    </div>
                    <div class="reservations-grid" id="inicio-reservations-grid">
                        <!-- Las reservas se cargan dinámicamente -->
                    </div>
                </div>

                <!-- Consumo de Servicios -->
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-chart-bar"></i> Mi Consumo</h2>
                        <div class="period-selector">
                            <select id="consumption-period" onchange="updateCharts()">
                                <option>Último mes</option>
                                <option>Últimos 3 meses</option>
                                <option>Este año</option>
                            </select>
                        </div>
                    </div>
                    <div class="consumption-cards">
                        <div class="consumption-card">
                            <div class="consumption-header">
                                <i class="fas fa-tint water"></i>
                                <span class="consumption-trend positive">-5%</span>
                            </div>
                            <h3>15.2 m³</h3>
                            <p>Consumo de agua</p>
                            <div class="consumption-comparison">
                                <span>Promedio vecinos: 12.8 m³</span>
                            </div>
                        </div>

                        <div class="consumption-card">
                            <div class="consumption-header">
                                <i class="fas fa-bolt energy"></i>
                                <span class="consumption-trend negative">+8%</span>
                            </div>
                            <h3>210.5 kWh</h3>
                            <p>Consumo eléctrico</p>
                            <div class="consumption-comparison">
                                <span>Promedio vecinos: 195.3 kWh</span>
                            </div>
                        </div>

                        <div class="consumption-card">
                            <div class="consumption-header">
                                <i class="fas fa-fire gas"></i>
                                <span class="consumption-trend positive">-3%</span>
                            </div>
                            <h3>8.7 m³</h3>
                            <p>Consumo de gas</p>
                            <div class="consumption-comparison">
                                <span>Promedio vecinos: 9.2 m³</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección Finanzas Mejorada -->
            <section id="finanzas" class="dashboard-section">
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-credit-card"></i> Mis Finanzas</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="downloadFinancialReport()">
                                <i class="fas fa-download"></i> Descargar Reporte
                            </button>
                            <button class="btn btn-secondary" onclick="askAIFinancialAdvice()">
                                <i class="fas fa-robot"></i> Asesoría IA
                            </button>
                        </div>
                    </div>
                    
                    <!-- Selector de Moneda -->
                    <div class="currency-selector">
                        <label for="currency-select">Moneda:</label>
                        <select id="currency-select" onchange="changeCurrency()">
                            <option value="BOB">Bolivianos (BOB)</option>
                            <option value="USD">Dólares (USD)</option>
                        </select>
                        <span class="exchange-rate">Tipo de cambio: 1 USD = 6.96 BOB</span>
                    </div>
                    
                    <!-- Resumen Financiero -->
                    <div class="financial-overview">
                        <div class="financial-card total">
                            <h3>Total Pendiente</h3>
                            <div class="amount" id="total-pending">$335.25</div>
                            <p>Vence en 15 días</p>
                        </div>
                        <div class="financial-card paid">
                            <h3>Pagado este mes</h3>
                            <div class="amount" id="total-paid">$450.00</div>
                            <p>Al día con los pagos</p>
                        </div>
                        <div class="financial-card upcoming">
                            <h3>Próximos</h3>
                            <div class="amount" id="total-upcoming">$185.50</div>
                            <p>Vence el próximo mes</p>
                        </div>
                        <div class="financial-card savings">
                            <h3>Ahorro Mensual</h3>
                            <div class="amount" id="total-savings">$45.75</div>
                            <p>Comparado con mes anterior</p>
                        </div>
                    </div>
                    
                    <!-- Gráficas Financieras Avanzadas -->
                    <div class="financial-charts-section">
                        <div class="chart-row">
                            <div class="chart-container">
                                <h3>Evolución de Gastos</h3>
                                <canvas id="expensesChart" width="400" height="300"></canvas>
                            </div>
                            <div class="chart-container">
                                <h3>Distribución de Pagos</h3>
                                <canvas id="paymentsDistributionChart" width="400" height="300"></canvas>
                            </div>
                        </div>
                        <div class="chart-row">
                            <div class="chart-container">
                                <h3>Comparativa con Vecinos</h3>
                                <canvas id="neighborsComparisonChart" width="400" height="300"></canvas>
                            </div>
                            <div class="chart-container">
                                <h3>Proyección Financiera</h3>
                                <canvas id="financialProjectionChart" width="400" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Filtros de Pagos -->
                    <div class="filters-row">
                        <div class="filter-group">
                            <label for="payment-status-filter">Estado:</label>
                            <select id="payment-status-filter" onchange="filterPayments()">
                                <option value="all">Todos</option>
                                <option value="pending">Pendientes</option>
                                <option value="paid">Pagados</option>
                                <option value="overdue">Vencidos</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="payment-category-filter">Categoría:</label>
                            <select id="payment-category-filter" onchange="filterPayments()">
                                <option value="all">Todas</option>
                                <option value="rent">Alquiler</option>
                                <option value="maintenance">Mantenimiento</option>
                                <option value="utilities">Servicios</option>
                                <option value="expenses">Expensas</option>
                                <option value="other">Otros</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="payment-date-filter">Fecha:</label>
                            <select id="payment-date-filter" onchange="filterPayments()">
                                <option value="all">Todas</option>
                                <option value="this-month">Este mes</option>
                                <option value="next-month">Próximo mes</option>
                                <option value="overdue">Vencidos</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="search-payments">Buscar:</label>
                            <input type="text" id="search-payments" placeholder="Buscar pagos..." onkeyup="searchPayments()">
                        </div>
                    </div>
                    
                    <!-- Lista de Pagos Completa -->
                    <div class="payments-section">
                        <div class="section-subheader">
                            <h3><i class="fas fa-list"></i> Todos los Pagos</h3>
                            <button class="btn btn-outline" onclick="showAllPayments()">
                                <i class="fas fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                        
                        <div class="payments-table-container">
                            <div class="payments-table">
                                <div class="table-header">
                                    <div class="table-cell">Fecha Venc.</div>
                                    <div class="table-cell">Descripción</div>
                                    <div class="table-cell">Categoría</div>
                                    <div class="table-cell">Monto</div>
                                    <div class="table-cell">Estado</div>
                                    <div class="table-cell">Acciones</div>
                                </div>
                                <div class="table-body" id="payments-table-body">
                                    <!-- Los pagos se cargan dinámicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Historial de Pagos -->
                    <div class="payment-history">
                        <h3><i class="fas fa-history"></i> Historial de Pagos</h3>
                        <div class="history-table">
                            <div class="table-header">
                                <div class="table-cell">Fecha Pago</div>
                                <div class="table-cell">Descripción</div>
                                <div class="table-cell">Método</div>
                                <div class="table-cell">Monto</div>
                                <div class="table-cell">Referencia</div>
                                <div class="table-cell">Acciones</div>
                            </div>
                            <div class="table-body" id="payment-history-body">
                                <!-- El historial se carga dinámicamente -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección Reservas Mejorada -->
            <section id="reservas" class="dashboard-section">
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-calendar-check"></i> Mis Reservas</h2>
                        <button class="btn btn-primary" onclick="openQuickReserve()">
                            <i class="fas fa-plus"></i> Nueva Reserva
                        </button>
                    </div>
                    
                    <!-- Filtros de Reservas Mejorados -->
                    <div class="filters-row">
                        <div class="filter-group">
                            <label for="reservation-status-filter">Estado:</label>
                            <select id="reservation-status-filter" onchange="filterReservations()">
                                <option value="all">Todas</option>
                                <option value="confirmed">Confirmadas</option>
                                <option value="pending">Pendientes</option>
                                <option value="cancelled">Canceladas</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="reservation-area-filter">Área:</label>
                            <select id="reservation-area-filter" onchange="filterReservations()">
                                <option value="all">Todas</option>
                                <option value="sala-eventos">Sala de Eventos</option>
                                <option value="gimnasio">Gimnasio</option>
                                <option value="piscina">Piscina</option>
                                <option value="terraza">Terraza</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="reservation-date-filter">Fecha:</label>
                            <select id="reservation-date-filter" onchange="filterReservations()">
                                <option value="all">Todas</option>
                                <option value="this-week">Esta semana</option>
                                <option value="this-month">Este mes</option>
                                <option value="next-month">Próximo mes</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="search-reservations">Buscar:</label>
                            <input type="text" id="search-reservations" placeholder="Buscar reservas..." onkeyup="searchReservations()">
                        </div>
                    </div>
                    
                    <!-- Calendario de Reservas Interactivo -->
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <button class="btn btn-outline calendar-nav-btn" onclick="previousMonth()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <h3 id="current-month">Enero 2024</h3>
                            <button class="btn btn-outline calendar-nav-btn" onclick="nextMonth()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        <div class="calendar" id="reservation-calendar">
                            <!-- El calendario se genera dinámicamente con JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Lista de Reservas -->
                    <div class="reservations-list-section">
                        <h3>Mis Reservas Activas</h3>
                        <div class="reservations-grid" id="reservations-grid">
                            <!-- Las reservas se cargan dinámicamente -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección Áreas Comunes MEJORADA -->
            <section id="areas-comunes" class="dashboard-section">
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-swimming-pool"></i> Áreas Comunes</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="openAreaReservation()">
                                <i class="fas fa-plus"></i> Nueva Reserva
                            </button>
                            <button class="btn btn-secondary" onclick="refreshAreasComunes()">
                                <i class="fas fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                    </div>
                    
                    <!-- Selector de Área -->
                    <div class="area-selector">
                        <div class="area-cards">
                            <div class="area-card active" data-area="sala-eventos">
                                <div class="area-icon">
                                    <i class="fas fa-glass-cheers"></i>
                                </div>
                                <h4>Sala de Eventos</h4>
                                <p>Capacidad: 50 personas</p>
                                <div class="area-status available">Disponible</div>
                            </div>
                            <div class="area-card" data-area="gimnasio">
                                <div class="area-icon">
                                    <i class="fas fa-dumbbell"></i>
                                </div>
                                <h4>Gimnasio</h4>
                                <p>Equipamiento completo</p>
                                <div class="area-status available">Disponible</div>
                            </div>
                            <div class="area-card" data-area="piscina">
                                <div class="area-icon">
                                    <i class="fas fa-swimming-pool"></i>
                                </div>
                                <h4>Piscina</h4>
                                <p>25m climatizada</p>
                                <div class="area-status limited">Capacidad limitada</div>
                            </div>
                            <div class="area-card" data-area="terraza">
                                <div class="area-icon">
                                    <i class="fas fa-umbrella-beach"></i>
                                </div>
                                <h4>Terraza</h4>
                                <p>Vista panorámica</p>
                                <div class="area-status available">Disponible</div>
                            </div>
                            <div class="area-card" data-area="parqueo">
                                <div class="area-icon">
                                    <i class="fas fa-parking"></i>
                                </div>
                                <h4>Parqueo Visitantes</h4>
                                <p>Máx. 4 horas</p>
                                <div class="area-status limited">Espacios limitados</div>
                            </div>
                            <div class="area-card" data-area="sala-juegos">
                                <div class="area-icon">
                                    <i class="fas fa-gamepad"></i>
                                </div>
                                <h4>Sala de Juegos</h4>
                                <p>Mesa de pool, ping pong</p>
                                <div class="area-status available">Disponible</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Calendario Interactivo MEJORADO -->
                    <div class="calendar-section">
                        <div class="calendar-header">
                            <h3>Disponibilidad de Áreas Comunes</h3>
                            <div class="calendar-controls">
                                <button class="btn btn-outline" onclick="previousWeek()">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <span id="current-week">Semana 15-21 Ene 2024</span>
                                <button class="btn btn-outline" onclick="nextWeek()">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="time-slots-container">
                            <div class="time-slots-header">
                                <div class="time-label">Hora</div>
                                <div class="day-label">Lun 15</div>
                                <div class="day-label">Mar 16</div>
                                <div class="day-label">Mié 17</div>
                                <div class="day-label">Jue 18</div>
                                <div class="day-label">Vie 19</div>
                                <div class="day-label">Sáb 20</div>
                                <div class="day-label">Dom 21</div>
                            </div>
                            
                            <div class="time-slots-grid" id="time-slots-grid">
                                <!-- Los slots de tiempo se generan dinámicamente -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mis Reservas Activas -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2><i class="fas fa-calendar-check"></i> Mis Reservas Activas</h2>
                        </div>
                        <div class="active-reservations" id="active-reservations">
                            <!-- Las reservas activas se cargan dinámicamente -->
                        </div>
                    </div>
                    
                    <!-- Módulo de Pagos para Áreas Comunes -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2><i class="fas fa-credit-card"></i> Pagos de Áreas Comunes</h2>
                            <div class="section-actions">
                                <button class="btn btn-primary" onclick="openPaymentModal()">
                                    <i class="fas fa-plus"></i> Realizar Pago
                                </button>
                            </div>
                        </div>
                        
                        <!-- Resumen de Pagos -->
                        <div class="payment-summary-cards">
                            <div class="payment-summary-card">
                                <div class="payment-summary-icon">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="payment-summary-content">
                                    <h3 id="total-reservations-paid">3</h3>
                                    <p>Reservas Pagadas</p>
                                    <span class="payment-summary-amount">$450.00</span>
                                </div>
                            </div>
                            <div class="payment-summary-card">
                                <div class="payment-summary-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="payment-summary-content">
                                    <h3 id="pending-payments">1</h3>
                                    <p>Pagos Pendientes</p>
                                    <span class="payment-summary-amount">$100.00</span>
                                </div>
                            </div>
                            <div class="payment-summary-card">
                                <div class="payment-summary-icon">
                                    <i class="fas fa-history"></i>
                                </div>
                                <div class="payment-summary-content">
                                    <h3 id="total-payments">4</h3>
                                    <p>Total Pagos</p>
                                    <span class="payment-summary-amount">$550.00</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Historial de Pagos de Áreas Comunes -->
                        <div class="common-areas-payments">
                            <h3><i class="fas fa-list"></i> Historial de Pagos</h3>
                            <div class="payments-table-container">
                                <div class="payments-table">
                                    <div class="table-header">
                                        <div class="table-cell">Fecha</div>
                                        <div class="table-cell">Área</div>
                                        <div class="table-cell">Descripción</div>
                                        <div class="table-cell">Monto</div>
                                        <div class="table-cell">Estado</div>
                                        <div class="table-cell">Acciones</div>
                                    </div>
                                    <div class="table-body" id="common-areas-payments-body">
                                        <!-- Los pagos de áreas comunes se cargan dinámicamente -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tarifas y Políticas -->
                    <div class="pricing-section">
                        <h3>Tarifas y Políticas</h3>
                        <div class="pricing-cards">
                            <div class="pricing-card">
                                <h4>Sala de Eventos</h4>
                                <div class="price">$50 <span>/hora</span></div>
                                <ul>
                                    <li>Mínimo 2 horas</li>
                                    <li>Depósito reembolsable: $100</li>
                                    <li>Capacidad: 50 personas</li>
                                </ul>
                                <button class="btn btn-primary" onclick="selectAreaForPayment('sala-eventos', 50)">Pagar Ahora</button>
                            </div>
                            <div class="pricing-card">
                                <h4>Gimnasio</h4>
                                <div class="price">Gratis <span>/residentes</span></div>
                                <ul>
                                    <li>Acceso ilimitado</li>
                                    <li>Horario: 6:00 - 22:00</li>
                                    <li>Reserva máxima: 2 horas</li>
                                </ul>
                                <button class="btn btn-outline" onclick="selectAreaForPayment('gimnasio', 0)">Reservar</button>
                            </div>
                            <div class="pricing-card">
                                <h4>Piscina</h4>
                                <div class="price">$10 <span>/persona</span></div>
                                <ul>
                                    <li>Máximo 4 personas por reserva</li>
                                    <li>Sesiones de 2 horas</li>
                                    <li>Toalla incluida</li>
                                </ul>
                                <button class="btn btn-primary" onclick="selectAreaForPayment('piscina', 10)">Pagar Ahora</button>
                            </div>
                            <div class="pricing-card">
                                <h4>Terraza</h4>
                                <div class="price">$30 <span>/hora</span></div>
                                <ul>
                                    <li>Mínimo 1 hora</li>
                                    <li>Máximo 20 personas</li>
                                    <li>Incluye mobiliario básico</li>
                                </ul>
                                <button class="btn btn-primary" onclick="selectAreaForPayment('terraza', 30)">Pagar Ahora</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección Mantenimiento Mejorada -->
            <section id="mantenimiento" class="dashboard-section">
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-tools"></i> Mantenimiento Inteligente</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="openMaintenanceRequest()">
                                <i class="fas fa-plus"></i> Nueva Solicitud
                            </button>
                            <button class="btn btn-secondary" onclick="askAIMaintenanceHelp()">
                                <i class="fas fa-robot"></i> Ayuda IA
                            </button>
                        </div>
                    </div>
                    
                    <!-- Estadísticas Rápidas -->
                    <div class="maintenance-stats">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="open-tickets">2</h3>
                                <p>Abiertos</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-spinner"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="progress-tickets">1</h3>
                                <p>En Proceso</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="resolved-tickets">5</h3>
                                <p>Resueltos</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="avg-rating">4.8</h3>
                                <p>Calificación</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mantenimientos Programados -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2><i class="fas fa-calendar-alt"></i> Mantenimientos Programados</h2>
                            <div class="period-selector">
                                <select id="maintenance-schedule-filter" onchange="filterMaintenanceSchedule()">
                                    <option value="all">Todos</option>
                                    <option value="weekly">Semanal</option>
                                    <option value="monthly">Mensual</option>
                                    <option value="annual">Anual</option>
                                </select>
                            </div>
                        </div>
                        <div class="maintenance-schedule">
                            <div class="schedule-item">
                                <div class="schedule-icon">
                                    <i class="fas fa-calendar-week"></i>
                                </div>
                                <div class="schedule-content">
                                    <h4>Limpieza de áreas comunes</h4>
                                    <p>Limpieza profunda de pasillos, ascensores y recepción</p>
                                    <div class="schedule-meta">
                                        <span class="schedule-frequency weekly">Semanal</span>
                                        <span class="schedule-date">Todos los lunes a las 8:00 AM</span>
                                    </div>
                                </div>
                                <div class="schedule-status">
                                    <span class="status-badge upcoming">Próximo: 22 Ene</span>
                                </div>
                            </div>
                            
                            <div class="schedule-item">
                                <div class="schedule-icon">
                                    <i class="fas fa-tools"></i>
                                </div>
                                <div class="schedule-content">
                                    <h4>Mantenimiento de ascensores</h4>
                                    <p>Revisión técnica y mantenimiento preventivo</p>
                                    <div class="schedule-meta">
                                        <span class="schedule-frequency monthly">Mensual</span>
                                        <span class="schedule-date">Primer viernes de cada mes</span>
                                    </div>
                                </div>
                                <div class="schedule-status">
                                    <span class="status-badge upcoming">Próximo: 2 Feb</span>
                                </div>
                            </div>
                            
                            <div class="schedule-item">
                                <div class="schedule-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="schedule-content">
                                    <h4>Prueba de sistemas de seguridad</h4>
                                    <p>Verificación de alarmas y sistemas de emergencia</p>
                                    <div class="schedule-meta">
                                        <span class="schedule-frequency quarterly">Trimestral</span>
                                        <span class="schedule-date">Cada 3 meses</span>
                                    </div>
                                </div>
                                <div class="schedule-status">
                                    <span class="status-badge upcoming">Próximo: 15 Mar</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Solicitudes de Mantenimiento -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2><i class="fas fa-list"></i> Mis Solicitudes</h2>
                            <div class="section-actions">
                                <button class="btn btn-outline" onclick="refreshMaintenanceRequests()">
                                    <i class="fas fa-sync-alt"></i> Actualizar
                                </button>
                            </div>
                        </div>
                        
                        <div class="maintenance-requests" id="maintenance-requests">
                            <!-- Las solicitudes se cargan dinámicamente -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección Emergencias -->
            <section id="emergencias" class="dashboard-section">
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-exclamation-triangle"></i> Emergencias</h2>
                        <div class="emergency-actions">
                            <button class="btn btn-danger btn-glow" onclick="triggerEmergency('security')">
                                <i class="fas fa-shield-alt"></i> Seguridad
                            </button>
                            <button class="btn btn-warning btn-glow" onclick="triggerEmergency('medical')">
                                <i class="fas fa-ambulance"></i> Médica
                            </button>
                            <button class="btn btn-info btn-glow" onclick="triggerEmergency('fire')">
                                <i class="fas fa-fire-extinguisher"></i> Incendio
                            </button>
                        </div>
                    </div>
                    
                    <!-- Números de Emergencia -->
                    <div class="emergency-contacts">
                        <h3>Contactos de Emergencia</h3>
                        <div class="contact-cards">
                            <div class="contact-card">
                                <div class="contact-icon police">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <h4>Policía</h4>
                                <div class="contact-number">110</div>
                                <button class="btn btn-outline" onclick="callEmergency('110')">
                                    <i class="fas fa-phone"></i> Llamar
                                </button>
                            </div>
                            <div class="contact-card">
                                <div class="contact-icon medical">
                                    <i class="fas fa-ambulance"></i>
                                </div>
                                <h4>Emergencias Médicas</h4>
                                <div class="contact-number">911</div>
                                <button class="btn btn-outline" onclick="callEmergency('911')">
                                    <i class="fas fa-phone"></i> Llamar
                                </button>
                            </div>
                            <div class="contact-card">
                                <div class="contact-icon fire">
                                    <i class="fas fa-fire-extinguisher"></i>
                                </div>
                                <h4>Bomberos</h4>
                                <div class="contact-number">119</div>
                                <button class="btn btn-outline" onclick="callEmergency('119')">
                                    <i class="fas fa-phone"></i> Llamar
                                </button>
                            </div>
                            <div class="contact-card">
                                <div class="contact-icon security">
                                    <i class="fas fa-user-shield"></i>
                                </div>
                                <h4>Seguridad Edificio</h4>
                                <div class="contact-number">+591 1234-5678</div>
                                <button class="btn btn-outline" onclick="callEmergency('+59112345678')">
                                    <i class="fas fa-phone"></i> Llamar
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Protocolos de Emergencia -->
                    <div class="emergency-protocols">
                        <h3>Protocolos de Emergencia</h3>
                        <div class="protocol-cards">
                            <div class="protocol-card">
                                <h4>Incendio</h4>
                                <ul>
                                    <li>Mantenga la calma y active la alarma más cercana</li>
                                    <li>Use las escaleras, NO use los ascensores</li>
                                    <li>Siga las rutas de evacuación señalizadas</li>
                                    <li>Reúnase en el punto de encuentro designado</li>
                                </ul>
                            </div>
                            <div class="protocol-card">
                                <h4>Sismo</h4>
                                <ul>
                                    <li>Busque refugio bajo muebles resistentes</li>
                                    <li>Aléjese de ventanas y objetos que puedan caer</li>
                                    <li>Si está en exteriores, aléjese de edificios</li>
                                    <li>Después del sismo, evacúe ordenadamente</li>
                                </ul>
                            </div>
                            <div class="protocol-card">
                                <h4>Emergencia Médica</h4>
                                <ul>
                                    <li>Llame al 911 inmediatamente</li>
                                    <li>No mueva a la persona si hay lesión grave</li>
                                    <li>Alerte al personal de seguridad del edificio</li>
                                    <li>Prepare información médica relevante</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Rutas de Evacuación -->
                    <div class="evacuation-routes">
                        <h3>Rutas de Evacuación</h3>
                        <div class="floor-plans">
                            <div class="floor-plan">
                                <h4>Torre 1 - Planta Baja</h4>
                                <div class="plan-image">
                                    <img src="https://via.placeholder.com/400x300?text=Plano+Evacuación+Torre+1" alt="Plano Torre 1">
                                </div>
                                <div class="plan-legend">
                                    <div class="legend-item">
                                        <span class="legend-color exit"></span>
                                        <span>Salida de Emergencia</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color route"></span>
                                        <span>Ruta de Evacuación</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color meeting"></span>
                                        <span>Punto de Encuentro</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección Mi Consumo -->
            <section id="consumo" class="dashboard-section">
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-chart-pie"></i> Mi Consumo Inteligente</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="downloadConsumptionReport()">
                                <i class="fas fa-download"></i> Reporte
                            </button>
                            <button class="btn btn-secondary" onclick="askAIConsumptionTips()">
                                <i class="fas fa-robot"></i> Tips IA
                            </button>
                        </div>
                    </div>
                    
                    <!-- Selector de Periodo -->
                    <div class="period-selector-large">
                        <div class="period-options">
                            <button class="period-btn active" data-period="month">Este Mes</button>
                            <button class="period-btn" data-period="quarter">Últimos 3 Meses</button>
                            <button class="period-btn" data-period="year">Este Año</button>
                            <button class="period-btn" data-period="custom">Personalizado</button>
                        </div>
                        <div class="date-range-selector" id="date-range-selector" style="display: none;">
                            <input type="date" id="start-date">
                            <span>a</span>
                            <input type="date" id="end-date">
                            <button class="btn btn-primary" onclick="applyCustomDateRange()">Aplicar</button>
                        </div>
                    </div>
                    
                    <!-- Resumen de Consumo -->
                    <div class="consumption-overview">
                        <div class="consumption-summary-card">
                            <h3>Resumen de Consumo</h3>
                            <div class="consumption-totals">
                                <div class="total-item">
                                    <span class="total-label">Agua</span>
                                    <span class="total-value">15.2 m³</span>
                                    <span class="total-trend negative">+5%</span>
                                </div>
                                <div class="total-item">
                                    <span class="total-label">Energía</span>
                                    <span class="total-value">210.5 kWh</span>
                                    <span class="total-trend positive">-8%</span>
                                </div>
                                <div class="total-item">
                                    <span class="total-label">Gas</span>
                                    <span class="total-value">8.7 m³</span>
                                    <span class="total-trend positive">-3%</span>
                                </div>
                                <div class="total-item">
                                    <span class="total-label">Total Estimado</span>
                                    <span class="total-value">$185.75</span>
                                    <span class="total-trend positive">-12%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="consumption-comparison-card">
                            <h3>Comparativa con Vecinos</h3>
                            <div class="comparison-items">
                                <div class="comparison-item">
                                    <span class="comparison-label">Tu consumo</span>
                                    <div class="comparison-bar">
                                        <div class="bar-fill your-consumption" style="width: 65%"></div>
                                    </div>
                                    <span class="comparison-value">65%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="comparison-label">Promedio edificio</span>
                                    <div class="comparison-bar">
                                        <div class="bar-fill average-consumption" style="width: 100%"></div>
                                    </div>
                                    <span class="comparison-value">100%</span>
                                </div>
                                <div class="comparison-item">
                                    <span class="comparison-label">Vecino más eficiente</span>
                                    <div class="comparison-bar">
                                        <div class="bar-fill efficient-consumption" style="width: 45%"></div>
                                    </div>
                                    <span class="comparison-value">45%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráficas de Consumo Detalladas -->
                    <div class="consumption-charts-section">
                        <div class="chart-row">
                            <div class="chart-container large">
                                <h3>Evolución del Consumo</h3>
                                <canvas id="consumptionEvolutionChart" width="600" height="400"></canvas>
                            </div>
                        </div>
                        <div class="chart-row">
                            <div class="chart-container">
                                <h3>Distribución por Servicio</h3>
                                <canvas id="consumptionDistributionChart" width="400" height="300"></canvas>
                            </div>
                            <div class="chart-container">
                                <h3>Comparativa Horaria</h3>
                                <canvas id="hourlyComparisonChart" width="400" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recomendaciones de Ahorro -->
                    <div class="savings-recommendations">
                        <h3><i class="fas fa-lightbulb"></i> Recomendaciones de Ahorro</h3>
                        <div class="recommendations-grid">
                            <div class="recommendation-card">
                                <div class="recommendation-icon energy">
                                    <i class="fas fa-bolt"></i>
                                </div>
                                <h4>Optimiza tu consumo eléctrico</h4>
                                <p>Tu consumo en horas pico es 15% mayor al promedio. Programa electrodomésticos para horas valle.</p>
                                <div class="savings-potential">
                                    <span>Ahorro potencial: $25/mes</span>
                                </div>
                                <button class="btn btn-outline">Ver detalles</button>
                            </div>
                            <div class="recommendation-card">
                                <div class="recommendation-icon water">
                                    <i class="fas fa-tint"></i>
                                </div>
                                <h4>Reduce el consumo de agua</h4>
                                <p>Considera instalar aireadores en grifería y revisar posibles fugas en el sistema.</p>
                                <div class="savings-potential">
                                    <span>Ahorro potencial: $15/mes</span>
                                </div>
                                <button class="btn btn-outline">Ver detalles</button>
                            </div>
                            <div class="recommendation-card">
                                <div class="recommendation-icon gas">
                                    <i class="fas fa-fire"></i>
                                </div>
                                <h4>Mejora eficiencia de calefacción</h4>
                                <p>Ajusta el termostato 2°C menos durante la noche para ahorrar en calefacción.</p>
                                <div class="savings-potential">
                                    <span>Ahorro potencial: $18/mes</span>
                                </div>
                                <button class="btn btn-outline">Ver detalles</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección Comunidad -->
            <section id="comunidad" class="dashboard-section">
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-users"></i> Comunidad</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="openNewPost()">
                                <i class="fas fa-plus"></i> Nueva Publicación
                            </button>
                            <button class="btn btn-secondary" onclick="refreshCommunity()">
                                <i class="fas fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                    </div>
                    
                    <!-- Estadísticas de la Comunidad -->
                    <div class="community-stats">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-user-friends"></i>
                            </div>
                            <div class="stat-content">
                                <h3>48</h3>
                                <p>Residentes</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-home"></i>
                            </div>
                            <div class="stat-content">
                                <h3>36</h3>
                                <p>Departamentos</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-calendar-day"></i>
                            </div>
                            <div class="stat-content">
                                <h3>3</h3>
                                <p>Eventos este mes</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="stat-content">
                                <h3>12</h3>
                                <p>Discusiones activas</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Feed de la Comunidad -->
                    <div class="community-feed">
                        <div class="feed-header">
                            <h3>Últimas Publicaciones</h3>
                            <div class="feed-filters">
                                <select id="feed-filter" onchange="filterCommunityFeed()">
                                    <option value="all">Todas</option>
                                    <option value="announcements">Anuncios</option>
                                    <option value="events">Eventos</option>
                                    <option value="discussions">Discusiones</option>
                                    <option value="help">Ayuda</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="feed-content" id="community-feed">
                            <!-- El feed se carga dinámicamente -->
                        </div>
                    </div>
                    
                    <!-- Eventos de la Comunidad -->
                    <div class="community-events">
                        <h3>Próximos Eventos</h3>
                        <div class="events-grid" id="community-events">
                            <!-- Los eventos se cargan dinámicamente -->
                        </div>
                    </div>
                    
                    <!-- Directorio de Residentes -->
                    <div class="residents-directory">
                        <h3>Directorio de Residentes</h3>
                        <div class="directory-filters">
                            <input type="text" id="search-residents" placeholder="Buscar residentes..." onkeyup="searchResidents()">
                            <select id="tower-filter" onchange="filterResidents()">
                                <option value="all">Todas las torres</option>
                                <option value="torre1">Torre 1</option>
                                <option value="torre2">Torre 2</option>
                            </select>
                        </div>
                        <div class="residents-grid" id="residents-grid">
                            <!-- Los residentes se cargan dinámicamente -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sección Configuración -->
            <section id="configuracion" class="dashboard-section">
                <div class="content-section">
                    <div class="section-header">
                        <h2><i class="fas fa-cog"></i> Configuración</h2>
                        <div class="section-actions">
                            <button class="btn btn-primary" onclick="saveSettings()">
                                <i class="fas fa-save"></i> Guardar Cambios
                            </button>
                        </div>
                    </div>
                    
                    <!-- Perfil de Usuario -->
                    <div class="settings-section">
                        <h3><i class="fas fa-user"></i> Perfil de Usuario</h3>
                        <div class="settings-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="profile-name">Nombre Completo</label>
                                    <input type="text" id="profile-name" value="Juan Pérez">
                                </div>
                                <div class="form-group">
                                    <label for="profile-email">Correo Electrónico</label>
                                    <input type="email" id="profile-email" value="juan.perez@email.com">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="profile-phone">Teléfono</label>
                                    <input type="tel" id="profile-phone" value="+591 1234-5678">
                                </div>
                                <div class="form-group">
                                    <label for="profile-apartment">Departamento</label>
                                    <input type="text" id="profile-apartment" value="5A - Torre 1" disabled>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="profile-avatar">Foto de Perfil</label>
                                    <div class="avatar-upload">
                                        <img src="https://ui-avatars.com/api/?name=Juan+Perez&background=6366f1&color=fff" alt="Avatar" id="profile-avatar-preview">
                                        <input type="file" id="profile-avatar" accept="image/*" onchange="previewAvatar(this)">
                                        <label for="profile-avatar" class="btn btn-outline">Cambiar Foto</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Preferencias de Notificaciones -->
                    <div class="settings-section">
                        <h3><i class="fas fa-bell"></i> Notificaciones</h3>
                        <div class="notification-preferences">
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h4>Notificaciones por Email</h4>
                                    <p>Recibir recordatorios y actualizaciones por correo electrónico</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="email-notifications" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h4>Notificaciones Push</h4>
                                    <p>Recibir notificaciones en tiempo real en el navegador</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="push-notifications" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h4>Recordatorios de Pago</h4>
                                    <p>Alertas antes del vencimiento de pagos</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="payment-reminders" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h4>Actualizaciones de Mantenimiento</h4>
                                    <p>Notificaciones sobre el estado de solicitudes de mantenimiento</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="maintenance-updates" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h4>Eventos de la Comunidad</h4>
                                    <p>Información sobre eventos y actividades del edificio</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="community-events-notifications" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Preferencias de Privacidad -->
                    <div class="settings-section">
                        <h3><i class="fas fa-shield-alt"></i> Privacidad</h3>
                        <div class="privacy-preferences">
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h4>Perfil Público</h4>
                                    <p>Permitir que otros residentes vean mi información de contacto</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="public-profile">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h4>Compartir Consumo</h4>
                                    <p>Permitir comparativa anónima de consumo con otros residentes</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="share-consumption" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h4>Mostrar en Directorio</h4>
                                    <p>Aparecer en el directorio de residentes de la comunidad</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="show-in-directory" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Configuración de la Cuenta -->
                    <div class="settings-section">
                        <h3><i class="fas fa-key"></i> Seguridad de la Cuenta</h3>
                        <div class="account-settings">
                            <div class="security-actions">
                                <button class="btn btn-outline" onclick="changePassword()">
                                    <i class="fas fa-lock"></i> Cambiar Contraseña
                                </button>
                                <button class="btn btn-outline" onclick="enableTwoFactor()">
                                    <i class="fas fa-mobile-alt"></i> Autenticación 2FA
                                </button>
                                <button class="btn btn-outline" onclick="viewLoginHistory()">
                                    <i class="fas fa-history"></i> Historial de Accesos
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Preferencias de la Aplicación -->
                    <div class="settings-section">
                        <h3><i class="fas fa-palette"></i> Apariencia</h3>
                        <div class="appearance-settings">
                            <div class="theme-selector">
                                <h4>Tema de Color</h4>
                                <div class="theme-options">
                                    <div class="theme-option active" data-theme="light">
                                        <div class="theme-preview light"></div>
                                        <span>Claro</span>
                                    </div>
                                    <div class="theme-option" data-theme="dark">
                                        <div class="theme-preview dark"></div>
                                        <span>Oscuro</span>
                                    </div>
                                    <div class="theme-option" data-theme="auto">
                                        <div class="theme-preview auto"></div>
                                        <span>Automático</span>
                                    </div>
                                </div>
                            </div>
                            <div class="language-selector">
                                <h4>Idioma</h4>
                                <select id="language-select">
                                    <option value="es">Español</option>
                                    <option value="en">English</option>
                                    <option value="pt">Português</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Asistente IA Flotante -->
    <div class="ai-assistant-floating" id="aiAssistant">
        <div class="ai-header">
            <div class="ai-avatar">
                <i class="fas fa-robot"></i>
            </div>
            <div class="ai-info">
                <h4>Asistente IA</h4>
                <p>¿En qué puedo ayudarte?</p>
            </div>
            <button class="ai-close" onclick="toggleAIAssistant()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="ai-content">
            <div class="ai-message user">
                <p>Hola, ¿puedes ayudarme con mi consumo de energía?</p>
            </div>
            <div class="ai-message assistant">
                <p>¡Claro! Veo que tu consumo de energía aumentó 8% este mes. Te recomiendo revisar el uso del aire acondicionado durante las horas pico.</p>
            </div>
        </div>
        <div class="ai-input">
            <input type="text" placeholder="Escribe tu pregunta..." id="ai-input">
            <button class="ai-send" onclick="sendAIMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Modal de Reserva Rápida -->
    <div class="modal" id="quickReserveModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nueva Reserva</h3>
                <button class="modal-close" onclick="closeQuickReserve()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="quick-reserve-form">
                    <div class="form-group">
                        <label for="reserve-area">Área a Reservar</label>
                        <select id="reserve-area" required>
                            <option value="">Seleccionar área...</option>
                            <option value="sala-eventos">Sala de Eventos</option>
                            <option value="gimnasio">Gimnasio</option>
                            <option value="piscina">Piscina</option>
                            <option value="terraza">Terraza</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="reserve-date">Fecha</label>
                            <input type="date" id="reserve-date" required>
                        </div>
                        <div class="form-group">
                            <label for="reserve-time">Hora</label>
                            <input type="time" id="reserve-time" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="reserve-duration">Duración (horas)</label>
                        <select id="reserve-duration" required>
                            <option value="1">1 hora</option>
                            <option value="2">2 horas</option>
                            <option value="3">3 horas</option>
                            <option value="4">4 horas</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="reserve-notes">Notas Adicionales</label>
                        <textarea id="reserve-notes" rows="3" placeholder="Información adicional para la reserva..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeQuickReserve()">Cancelar</button>
                <button class="btn btn-primary" onclick="submitQuickReserve()">Confirmar Reserva</button>
            </div>
        </div>
    </div>

    <!-- Modal de Solicitud de Mantenimiento -->
    <div class="modal" id="maintenanceRequestModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nueva Solicitud de Mantenimiento</h3>
                <button class="modal-close" onclick="closeMaintenanceRequest()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="maintenance-request-form">
                    <div class="form-group">
                        <label for="maintenance-type">Tipo de Problema</label>
                        <select id="maintenance-type" required>
                            <option value="">Seleccionar tipo...</option>
                            <option value="plomeria">Plomería</option>
                            <option value="electricidad">Electricidad</option>
                            <option value="pintura">Pintura</option>
                            <option value="carpinteria">Carpintería</option>
                            <option value="limpieza">Limpieza</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="maintenance-urgency">Urgencia</label>
                        <select id="maintenance-urgency" required>
                            <option value="baja">Baja</option>
                            <option value="media">Media</option>
                            <option value="alta">Alta</option>
                            <option value="emergencia">Emergencia</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="maintenance-description">Descripción del Problema</label>
                        <textarea id="maintenance-description" rows="4" required placeholder="Describe detalladamente el problema..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="maintenance-photos">Fotos (opcional)</label>
                        <input type="file" id="maintenance-photos" multiple accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="maintenance-access">Disponibilidad de Acceso</label>
                        <input type="text" id="maintenance-access" placeholder="Ej: Lunes a Viernes 9:00-17:00">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeMaintenanceRequest()">Cancelar</button>
                <button class="btn btn-primary" onclick="submitMaintenanceRequest()">Enviar Solicitud</button>
            </div>
        </div>
    </div>

    <!-- Modal de Pago para Reservas -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Procesar Pago</h3>
                <button class="modal-close" onclick="closePaymentModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="payment-summary">
                    <h4>Resumen de la Reserva</h4>
                    <div class="payment-details">
                        <div class="payment-item">
                            <span>Área:</span>
                            <span id="payment-area">Sala de Eventos</span>
                        </div>
                        <div class="payment-item">
                            <span>Fecha:</span>
                            <span id="payment-date">20 Ene 2024</span>
                        </div>
                        <div class="payment-item">
                            <span>Hora:</span>
                            <span id="payment-time">14:00 - 16:00</span>
                        </div>
                        <div class="payment-item">
                            <span>Duración:</span>
                            <span id="payment-duration">2 horas</span>
                        </div>
                        <div class="payment-item total">
                            <span>Total a pagar:</span>
                            <span id="payment-total">$100.00</span>
                        </div>
                    </div>
                </div>
                
                <div class="payment-methods">
                    <h4>Selecciona método de pago</h4>
                    <div class="payment-options">
                        <div class="payment-option" data-method="credit-card">
                            <input type="radio" id="credit-card" name="payment-method" value="credit-card" checked>
                            <label for="credit-card">
                                <i class="fas fa-credit-card"></i>
                                <span>Tarjeta de Crédito/Débito</span>
                            </label>
                        </div>
                        <div class="payment-option" data-method="paypal">
                            <input type="radio" id="paypal" name="payment-method" value="paypal">
                            <label for="paypal">
                                <i class="fab fa-paypal"></i>
                                <span>PayPal</span>
                            </label>
                        </div>
                        <div class="payment-option" data-method="transfer">
                            <input type="radio" id="transfer" name="payment-method" value="transfer">
                            <label for="transfer">
                                <i class="fas fa-university"></i>
                                <span>Transferencia Bancaria</span>
                            </label>
                        </div>
                        <div class="payment-option" data-method="crypto">
                            <input type="radio" id="crypto" name="payment-method" value="crypto">
                            <label for="crypto">
                                <i class="fab fa-bitcoin"></i>
                                <span>Criptomonedas</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Formulario de Tarjeta de Crédito -->
                    <div class="payment-form" id="credit-card-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="card-number">Número de Tarjeta</label>
                                <input type="text" id="card-number" placeholder="1234 5678 9012 3456" maxlength="19">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="card-name">Nombre en la Tarjeta</label>
                                <input type="text" id="card-name" placeholder="JUAN PEREZ">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="card-expiry">Fecha de Vencimiento</label>
                                <input type="text" id="card-expiry" placeholder="MM/AA" maxlength="5">
                            </div>
                            <div class="form-group">
                                <label for="card-cvv">CVV</label>
                                <input type="text" id="card-cvv" placeholder="123" maxlength="3">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Información para Transferencia Bancaria -->
                    <div class="payment-form" id="transfer-form" style="display: none;">
                        <div class="bank-info">
                            <p>Realiza la transferencia a la siguiente cuenta:</p>
                            <div class="bank-details">
                                <div class="bank-item">
                                    <span>Banco:</span>
                                    <span>Banco Nacional de Bolivia</span>
                                </div>
                                <div class="bank-item">
                                    <span>Cuenta:</span>
                                    <span>123-456-789</span>
                                </div>
                                <div class="bank-item">
                                    <span>Titular:</span>
                                    <span>BuildingPRO S.A.</span>
                                </div>
                                <div class="bank-item">
                                    <span>Referencia:</span>
                                    <span id="transfer-reference">RES-2024-001</span>
                                </div>
                            </div>
                            <p class="note">Una vez realizada la transferencia, envía el comprobante a pagos@buildingpro.com</p>
                        </div>
                    </div>
                    
                    <!-- Información para PayPal -->
                    <div class="payment-form" id="paypal-form" style="display: none;">
                        <div class="paypal-info">
                            <p>Serás redirigido a PayPal para completar tu pago de forma segura.</p>
                            <div class="paypal-button">
                                <button class="btn btn-paypal" onclick="processPayPalPayment()">
                                    <i class="fab fa-paypal"></i> Pagar con PayPal
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Información para Criptomonedas -->
                    <div class="payment-form" id="crypto-form" style="display: none;">
                        <div class="crypto-info">
                            <p>Selecciona la criptomoneda para realizar el pago:</p>
                            <div class="crypto-options">
                                <div class="crypto-option" data-crypto="bitcoin">
                                    <input type="radio" id="bitcoin" name="crypto-method" value="bitcoin" checked>
                                    <label for="bitcoin">
                                        <i class="fab fa-bitcoin"></i>
                                        <span>Bitcoin</span>
                                    </label>
                                </div>
                                <div class="crypto-option" data-crypto="ethereum">
                                    <input type="radio" id="ethereum" name="crypto-method" value="ethereum">
                                    <label for="ethereum">
                                        <i class="fab fa-ethereum"></i>
                                        <span>Ethereum</span>
                                    </label>
                                </div>
                            </div>
                            <div class="crypto-address">
                                <p>Envía el pago a la siguiente dirección:</p>
                                <div class="address-box">
                                    <span id="crypto-address">1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa</span>
                                    <button class="btn-copy" onclick="copyCryptoAddress()">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                                <p class="crypto-amount">Monto: <span id="crypto-amount">0.0025 BTC</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closePaymentModal()">Cancelar</button>
                <button class="btn btn-primary" id="process-payment-btn" onclick="processPayment()">Pagar $100.00</button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmación QR -->
    <div class="modal" id="qrModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirmación de Reserva</h3>
                <button class="modal-close" onclick="closeQRModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="qr-confirmation">
                    <div class="qr-code-container">
                        <div id="qr-code"></div>
                    </div>
                    <div class="reservation-details">
                        <h4>Reserva Confirmada</h4>
                        <div class="detail-item">
                            <span>Área:</span>
                            <span id="qr-area">Sala de Eventos</span>
                        </div>
                        <div class="detail-item">
                            <span>Fecha:</span>
                            <span id="qr-date">20 Ene 2024</span>
                        </div>
                        <div class="detail-item">
                            <span>Hora:</span>
                            <span id="qr-time">14:00 - 16:00</span>
                        </div>
                        <div class="detail-item">
                            <span>Código de Reserva:</span>
                            <span id="qr-code-number">RES-2024-001</span>
                        </div>
                        <div class="note">
                            <p><i class="fas fa-info-circle"></i> Presenta este código QR al ingresar al área común</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeQRModal()">Cerrar</button>
                <button class="btn btn-primary" onclick="downloadQRCode()">
                    <i class="fas fa-download"></i> Descargar QR
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="dashboard-residente.js"></script>
</body>
</html>